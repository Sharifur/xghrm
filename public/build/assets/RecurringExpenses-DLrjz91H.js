import{A as U}from"./AdminMaster-BKDcT64w.js";import{H as h,r as V,c as i,o as d,a as _,b as e,h as w,f as b,F as M,p as F,t as c,n as R,w as A,e as f,i as y,A as E,d as q,l as g,B as I,x as T}from"./app-qbVGY1Fu.js";import{S as p}from"./sweetalert2.esm.all-acGi8jXx.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={layout:U,name:"RecurringExpenses",components:{Head:h},props:{expenses:Array},setup(D){const t=g(!1),r=g(null),o=g(!1),u=g([...D.expenses]),s=I({name:"",description:"",default_amount:0,frequency:"monthly",icon:"fas fa-receipt",tooltip:"",type:"liability",currency:"BDT"}),x=l=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l||0),n=()=>{s.name="",s.description="",s.default_amount=0,s.frequency="monthly",s.icon="fas fa-receipt",s.tooltip="",s.type="liability",s.currency="BDT"},C=l=>{r.value=l,s.name=l.name,s.description=l.description,s.default_amount=l.default_amount,s.frequency="monthly",s.icon=l.icon,s.tooltip=l.tooltip,s.currency=l.currency||"BDT"},S=()=>{t.value=!1,r.value=null,n()};return{expenses:u,showAddModal:t,editingExpense:r,saving:o,form:s,formatNumber:x,editExpense:C,closeModal:S,saveExpense:async()=>{var l,B;o.value=!0;try{const m=r.value?route("admin.finance.recurring.expenses.update",r.value.id):route("admin.finance.recurring.expenses.store"),v=r.value?"put":"post",a=await T[v](m,s);if(a.data.success){if(r.value){const k=u.value.findIndex(N=>N.id===r.value.id);u.value[k]=a.data.expense}else u.value.push(a.data.expense);S(),p.fire({title:"Success!",text:a.data.message,icon:"success",confirmButtonColor:"#007bff",timer:3e3,timerProgressBar:!0})}}catch(m){console.error("Save failed:",m),p.fire({title:"Error!",text:((B=(l=m.response)==null?void 0:l.data)==null?void 0:B.message)||"Failed to save expense",icon:"error",confirmButtonColor:"#e74a3b"})}finally{o.value=!1}},deleteExpense:async l=>{var m,v;if((await p.fire({title:"Are you sure?",text:"You want to delete this recurring expense?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e74a3b",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{const a=await T.delete(route("admin.finance.recurring.expenses.delete",l));a.data.success&&(u.value=u.value.filter(k=>k.id!==l),p.fire({title:"Deleted!",text:a.data.message,icon:"success",confirmButtonColor:"#007bff",timer:3e3,timerProgressBar:!0}))}catch(a){console.error("Delete failed:",a),p.fire({title:"Error!",text:((v=(m=a.response)==null?void 0:m.data)==null?void 0:v.message)||"Failed to delete expense",icon:"error",confirmButtonColor:"#e74a3b"})}},updateConvertedAmount:()=>{}}}},Y={class:"row"},j={class:"col-lg-12"},W={class:"dashboard-settings margin-top-40"},z={class:"card mb-4"},L={class:"card-header d-flex justify-content-between align-items-center"},O={class:"card"},G={class:"card-body"},J={class:"table-responsive"},K={class:"table table-striped"},Q={class:"badge bg-warning text-dark"},X={key:0,class:"d-block mt-1 text-muted"},Z={class:"btn-group",role:"group"},$=["onClick"],ee=["onClick"],te={key:0},oe={class:"modal-header"},ne={class:"modal-body"},se={class:"row"},le={class:"col-md-6 mb-3"},ae={class:"col-md-6 mb-3"},re={class:"input-group"},ie={key:0,class:"form-text text-info"},de={key:1,class:"form-text text-muted"},ce={class:"row"},ue={class:"col-md-6 mb-3"},me={class:"col-md-6 mb-3"},fe={class:"mb-3"},be={class:"mb-3"},pe={class:"d-flex justify-content-end gap-2"},ve=["disabled"];function ye(D,t,r,o,u,s){const x=V("Head");return d(),i(M,null,[_(x,{title:"Recurring Expenses Management"}),e("div",Y,[e("div",j,[e("div",W,[e("div",z,[e("div",L,[t[15]||(t[15]=e("h4",{class:"mb-0"},[e("i",{class:"fas fa-repeat me-2"}),b(" Recurring Expenses Management ")],-1)),e("button",{onClick:t[0]||(t[0]=n=>o.showAddModal=!0),class:"btn btn-primary"},t[14]||(t[14]=[e("i",{class:"fas fa-plus"},null,-1),b(" Add Recurring Expense ")]))]),t[16]||(t[16]=e("div",{class:"card-body"},[e("p",{class:"text-muted"}," Manage monthly recurring expenses like server bills, office rent, subscriptions, etc. These will automatically appear in your balance sheet each month. ")],-1))]),e("div",O,[t[22]||(t[22]=e("div",{class:"card-header"},[e("h5",{class:"mb-0"},"Current Recurring Expenses")],-1)),e("div",G,[e("div",J,[e("table",K,[t[21]||(t[21]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Description"),e("th",null,"Amount & Currency"),e("th",null,"Frequency"),e("th",null,"Icon"),e("th",null,"Actions")])],-1)),e("tbody",null,[(d(!0),i(M,null,F(o.expenses,n=>(d(),i("tr",{key:n.id},[e("td",null,[e("strong",null,c(n.name),1)]),e("td",null,c(n.description||"-"),1),e("td",null,[e("span",Q,[b(c(n.currency==="USD"?"$":"৳")+c(o.formatNumber(n.default_amount))+" ",1),n.currency==="USD"?(d(),i("small",X," (৳"+c(o.formatNumber(n.default_amount*120))+" BDT) ",1)):w("",!0)])]),t[19]||(t[19]=e("td",null,[e("span",{class:"badge bg-info"},"Monthly")],-1)),e("td",null,[e("i",{class:R([n.icon||"fas fa-receipt","text-primary"])},null,2)]),e("td",null,[e("div",Z,[e("button",{onClick:C=>o.editExpense(n),class:"btn btn-sm btn-outline-primary"},t[17]||(t[17]=[e("i",{class:"fas fa-edit"},null,-1)]),8,$),e("button",{onClick:C=>o.deleteExpense(n.id),class:"btn btn-sm btn-outline-danger"},t[18]||(t[18]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ee)])])]))),128)),o.expenses.length===0?(d(),i("tr",te,t[20]||(t[20]=[e("td",{colspan:"6",class:"text-center text-muted"},' No recurring expenses found. Click "Add Recurring Expense" to get started. ',-1)]))):w("",!0)])])])])]),o.showAddModal||o.editingExpense?(d(),i("div",{key:0,class:"modal-overlay",onClick:t[13]||(t[13]=(...n)=>o.closeModal&&o.closeModal(...n))},[e("div",{class:"modal-content",onClick:t[12]||(t[12]=A(()=>{},["stop"]))},[e("div",oe,[e("h5",null,c(o.editingExpense?"Edit":"Add")+" Recurring Expense",1),e("button",{onClick:t[1]||(t[1]=(...n)=>o.closeModal&&o.closeModal(...n)),class:"btn-close"},"×")]),e("div",ne,[e("form",{onSubmit:t[11]||(t[11]=A((...n)=>o.saveExpense&&o.saveExpense(...n),["prevent"]))},[e("div",se,[e("div",le,[t[23]||(t[23]=e("label",{class:"form-label"},"Name *",-1)),f(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>o.form.name=n),type:"text",class:"form-control",required:"",placeholder:"e.g., Office Rent, Server Bills"},null,512),[[y,o.form.name]])]),e("div",ae,[t[27]||(t[27]=e("label",{class:"form-label"},"Default Amount *",-1)),e("div",re,[f(e("select",{"onUpdate:modelValue":t[3]||(t[3]=n=>o.form.currency=n),class:"input-group-text",style:{"border-right":"0",background:"#e9ecef"}},t[24]||(t[24]=[e("option",{value:"BDT"},"৳",-1),e("option",{value:"USD"},"$",-1)]),512),[[E,o.form.currency]]),f(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>o.form.default_amount=n),type:"number",class:"form-control",step:"0.01",min:"0",required:"",placeholder:"0.00",onInput:t[5]||(t[5]=(...n)=>o.updateConvertedAmount&&o.updateConvertedAmount(...n))},null,544),[[y,o.form.default_amount,void 0,{number:!0}]])]),o.form.currency==="USD"?(d(),i("div",ie,[e("small",null,[t[25]||(t[25]=e("i",{class:"fas fa-exchange-alt me-1"},null,-1)),b(" Converted: ৳"+c(o.formatNumber(o.form.default_amount*120))+" BDT (1 USD = 120 BDT) ",1)])])):(d(),i("div",de,t[26]||(t[26]=[e("small",null,"Amount in Bangladeshi Taka (BDT)",-1)])))])]),e("div",ce,[e("div",ue,[t[29]||(t[29]=e("label",{class:"form-label"},"Icon",-1)),f(e("select",{"onUpdate:modelValue":t[6]||(t[6]=n=>o.form.icon=n),class:"form-select"},t[28]||(t[28]=[q('<option value="fas fa-receipt" data-v-db67cbbc>Receipt (Default)</option><option value="fas fa-server" data-v-db67cbbc>Server</option><option value="fas fa-building" data-v-db67cbbc>Building/Rent</option><option value="fas fa-bolt" data-v-db67cbbc>Electricity</option><option value="fas fa-wifi" data-v-db67cbbc>Internet/WiFi</option><option value="fas fa-tools" data-v-db67cbbc>Tools/Software</option><option value="fas fa-broom" data-v-db67cbbc>Cleaning</option><option value="fas fa-shopping-cart" data-v-db67cbbc>Supplies</option><option value="fas fa-shield-alt" data-v-db67cbbc>Insurance</option><option value="fas fa-bullhorn" data-v-db67cbbc>Marketing</option><option value="fas fa-credit-card" data-v-db67cbbc>Payment/Subscription</option>',11)]),512),[[E,o.form.icon]])]),e("div",me,[t[31]||(t[31]=e("label",{class:"form-label"},"Frequency",-1)),f(e("select",{"onUpdate:modelValue":t[7]||(t[7]=n=>o.form.frequency=n),class:"form-select",required:""},t[30]||(t[30]=[e("option",{value:"monthly"},"Monthly",-1),e("option",{value:"yearly"},"Yearly",-1),e("option",{value:"weekly"},"Weekly",-1)]),512),[[E,o.form.frequency]])])]),e("div",fe,[t[32]||(t[32]=e("label",{class:"form-label"},"Description",-1)),f(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=n=>o.form.description=n),class:"form-control",rows:"3",placeholder:"Brief description of this expense"},null,512),[[y,o.form.description]])]),e("div",be,[t[33]||(t[33]=e("label",{class:"form-label"},"Tooltip (Help Text)",-1)),f(e("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>o.form.tooltip=n),type:"text",class:"form-control",placeholder:"Help text shown to users"},null,512),[[y,o.form.tooltip]])]),e("div",pe,[e("button",{type:"button",onClick:t[10]||(t[10]=(...n)=>o.closeModal&&o.closeModal(...n)),class:"btn btn-secondary"}," Cancel "),e("button",{type:"submit",class:"btn btn-primary",disabled:o.saving},[t[34]||(t[34]=e("i",{class:"fas fa-save"},null,-1)),b(" "+c(o.saving?"Saving...":"Save"),1)],8,ve)])],32)])])])):w("",!0)])])])],64)}const De=H(P,[["render",ye],["__scopeId","data-v-db67cbbc"]]);export{De as default};
