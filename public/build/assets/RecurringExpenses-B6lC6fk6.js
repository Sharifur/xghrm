import{A as pe}from"./AdminMaster-BGMkPzmn.js";import{H as xe,r as he,c as d,o as c,a as _e,b as e,h,f as b,t as u,e as k,i as F,F as N,p as j,j as W,n as C,w as z,A as O,d as ke,l as _,B as Ce,C as we,y as P,x as T,a0 as Ee}from"./app-CkHFsNZZ.js";import{S as g}from"./sweetalert2.esm.all-Y6IUEg8t.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Pe={layout:pe,name:"RecurringExpenses",components:{Head:xe},props:{expenses:Array},setup(G){const t=_(!1),w=_(null),s=_(!1),f=_([]),p=_([]),E=_(1),n=_(10),x=_(""),R=_(!1),U=_(null),m=Ce({name:"",description:"",default_amount:0,frequency:"monthly",icon:"fas fa-receipt",tooltip:"",type:"liability",currency:"BDT"}),I=120,D=_("BDT");we(()=>m.currency,a=>{const o=D.value;o&&m.default_amount>0&&o!==a&&(o==="BDT"&&a==="USD"?m.default_amount=Number((m.default_amount/I).toFixed(2)):o==="USD"&&a==="BDT"&&(m.default_amount=Number((m.default_amount*I).toFixed(2)))),D.value=a});const V=_(0),S=P(()=>Math.ceil(V.value/n.value)),A=P(()=>f.value),J=P(()=>f.value),K=P(()=>{const a=S.value,o=E.value,l=[];if(a<=7)for(let r=1;r<=a;r++)l.push(r);else if(o<=4){for(let r=1;r<=5;r++)l.push(r);l.push("..."),l.push(a)}else if(o>=a-3){l.push(1),l.push("...");for(let r=a-4;r<=a;r++)l.push(r)}else{l.push(1),l.push("...");for(let r=o-1;r<=o+1;r++)l.push(r);l.push("..."),l.push(a)}return l.filter(r=>r!=="..."||l.indexOf(r)!==l.lastIndexOf(r))}),Q=P(()=>A.value.length>0&&A.value.every(a=>p.value.includes(a.id))),X=P(()=>f.value.reduce((a,o)=>{const l=parseFloat(o.bdt_amount||o.amount||o.default_amount)||0;return o.frequency==="yearly"?a+l/12:o.frequency==="weekly"?a+l*4.33:a+l},0)),Z=P(()=>f.value.filter(a=>a.frequency==="weekly").reduce((a,o)=>{const l=parseFloat(o.bdt_amount||o.amount||o.default_amount)||0;return a+l},0)),$=P(()=>f.value.filter(a=>a.frequency==="yearly").reduce((a,o)=>{const l=parseFloat(o.bdt_amount||o.amount||o.default_amount)||0;return a+l},0)),M=a=>{const o=parseFloat(a)||0;return isNaN(o)?"0.00":new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(o)},L=a=>{console.log("Formatting frequency:",a);const l={monthly:"Monthly",yearly:"Yearly",weekly:"Weekly",daily:"Daily"}[a]||"Monthly";return console.log("Formatted result:",l),l},ee=a=>a==="monthly"?"bg-primary":a==="weekly"?"bg-success":a==="yearly"?"bg-danger":"bg-info",H=()=>{m.name="",m.description="",m.default_amount=0,m.frequency="monthly",m.icon="fas fa-receipt",m.tooltip="",m.type="liability",m.currency="BDT",D.value="BDT"},te=async()=>{H(),t.value=!0,await Ee(),D.value="BDT"},se=a=>{w.value=a,m.name=a.name,m.description=a.description,m.default_amount=a.amount||a.default_amount,m.frequency=a.frequency||"monthly",m.icon=a.icon,m.tooltip=a.tooltip,m.currency=a.currency||"BDT",D.value=a.currency||"BDT"},Y=()=>{t.value=!1,w.value=null,H()},ne=async()=>{var a,o;s.value=!0;try{const l=w.value?route("admin.finance.recurring.expenses.update",w.value.id):route("admin.finance.recurring.expenses.store"),r=w.value?"put":"post",v={...m};m.currency==="USD"&&(v.default_amount=m.default_amount*I,v.currency="BDT"),console.log("Saving expense with data:",{original:{currency:m.currency,amount:m.default_amount,frequency:m.frequency},saving:{currency:v.currency,amount:v.default_amount,frequency:v.frequency}});const i=await T[r](l,v);if(i.data.success){if(console.log("Server returned expense:",i.data.expense),w.value){const y=f.value.findIndex(B=>B.id===w.value.id);f.value[y]=i.data.expense}else f.value.push(i.data.expense);Y(),g.fire({title:"Success!",text:i.data.message,icon:"success",confirmButtonColor:"#007bff",timer:3e3,timerProgressBar:!0})}}catch(l){console.error("Save failed:",l),g.fire({title:"Error!",text:((o=(a=l.response)==null?void 0:a.data)==null?void 0:o.message)||"Failed to save expense",icon:"error",confirmButtonColor:"#e74a3b"})}finally{s.value=!1}},ae=async a=>{var l,r;if((await g.fire({title:"Are you sure?",text:"You want to delete this recurring expense?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e74a3b",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{const v=await T.delete(route("admin.finance.recurring.expenses.delete",a));v.data.success&&(f.value=f.value.filter(i=>i.id!==a),g.fire({title:"Deleted!",text:v.data.message,icon:"success",confirmButtonColor:"#007bff",timer:3e3,timerProgressBar:!0}))}catch(v){console.error("Delete failed:",v),g.fire({title:"Error!",text:((r=(l=v.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to delete expense",icon:"error",confirmButtonColor:"#e74a3b"})}},oe=()=>{},q=async(a=!1)=>{a&&(E.value=1),R.value=!0;try{const o={page:E.value,per_page:n.value};x.value.trim()&&(o.search=x.value.trim());const l=await T.get(route("admin.finance.recurring.expenses.with-status"),{params:o});l.data.success&&(f.value=l.data.expenses,V.value=l.data.pagination.total)}catch(o){console.error("Error fetching expenses:",o),g.fire({title:"Error!",text:"Failed to load expenses. Please try again.",icon:"error",confirmButtonColor:"#e74a3b"})}finally{R.value=!1}},le=()=>{x.value="",p.value=[],q(!0)},re=()=>{U.value&&clearTimeout(U.value),U.value=setTimeout(()=>{p.value=[],q(!0)},500)},ie=a=>{a>=1&&a<=S.value&&a!=="..."&&(E.value=a,p.value=[],q())},de=()=>{if(Q.value){const a=A.value.map(o=>o.id);p.value=p.value.filter(o=>!a.includes(o))}else{const o=A.value.map(l=>l.id).filter(l=>!p.value.includes(l));p.value.push(...o)}},ce=async()=>{if(p.value.length===0)return;const a=p.value.length,o=f.value.filter(y=>p.value.includes(y.id)),l=o.reduce((y,B)=>y+(B.bdt_amount||B.amount||B.default_amount),0),r=o.slice(0,5).map(y=>`• ${y.name}: ৳${M(y.bdt_amount||y.amount||y.default_amount)}`).join("<br>"),v=o.length>5?`<br>...and ${o.length-5} more expenses`:"";if((await g.fire({title:`Delete ${a} Selected Expenses?`,html:`<div class="text-left">
                    <p>This will permanently remove <strong>${a}</strong> recurring expenses:</p>
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0; font-size: 14px;">
                        ${r}
                        ${v}
                    </div>
                    <p><strong>Total Monthly Value:</strong> ৳${M(l)}</p>
                    <p class="text-danger mb-0"><i class="fas fa-exclamation-triangle"></i> This action cannot be undone!</p>
                </div>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#e74a3b",cancelButtonColor:"#6c757d",confirmButtonText:`Yes, delete ${a} expenses!`,cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{const y=p.value.map(B=>T.delete(route("admin.finance.recurring.expenses.delete",B)));await Promise.all(y),f.value=f.value.filter(B=>!p.value.includes(B.id)),p.value=[],E.value>S.value&&S.value>0&&(E.value=S.value),g.fire({title:"Expenses Deleted!",text:`Successfully removed ${a} recurring expenses.`,icon:"success",confirmButtonColor:"#007bff",timer:3e3,timerProgressBar:!0})}catch(y){console.error("Bulk delete failed:",y),g.fire({title:"Error!",text:"Failed to delete some expenses. Please try again.",icon:"error",confirmButtonColor:"#e74a3b"})}},ue=async()=>{const a=f.value.length,o=f.value.reduce((i,y)=>i+(y.bdt_amount||y.amount||y.default_amount),0),l=f.value.slice(0,5).map(i=>`• ${i.name}: ৳${M(i.bdt_amount||i.amount||i.default_amount)}`).join("<br>"),r=f.value.length>5?`<br>...and ${f.value.length-5} more expenses`:"";if((await g.fire({title:"Clear All Recurring Expenses?",html:`<div class="text-left">
                    <p>This will permanently remove <strong>${a}</strong> recurring expenses:</p>
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0; font-size: 14px;">
                        ${l}
                        ${r}
                    </div>
                    <p><strong>Total Monthly Value:</strong> ৳${M(o)}</p>
                    <p class="text-danger mb-0"><i class="fas fa-exclamation-triangle"></i> This action cannot be undone!</p>
                </div>`,icon:"error",showCancelButton:!0,confirmButtonColor:"#e74a3b",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, clear all expenses!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{const i=f.value.map(y=>T.delete(route("admin.finance.recurring.expenses.delete",y.id)));await Promise.all(i),f.value.splice(0),g.fire({title:"All Expenses Cleared!",text:`Successfully removed ${a} recurring expenses.`,icon:"success",confirmButtonColor:"#28a745",timer:3e3,timerProgressBar:!0})}catch(i){console.error("Bulk delete failed:",i),g.fire({title:"Error!",text:"Failed to clear some expenses. Please try again.",icon:"error",confirmButtonColor:"#e74a3b"})}},me=async()=>{const a=`Name,Description,Amount,Currency,BDT Equivalent,Frequency,Icon
`,o=f.value.map(i=>[`"${i.name}"`,`"${i.description||""}"`,(i.bdt_amount||i.amount||i.default_amount).toFixed(2),"BDT",(i.bdt_amount||i.amount||i.default_amount).toFixed(2),L(i.frequency),`"${i.icon||"fas fa-receipt"}"`].join(",")).join(`
`),l=a+o,r=new Blob([l],{type:"text/csv;charset=utf-8;"}),v=document.createElement("a");if(v.download!==void 0){const i=URL.createObjectURL(r);v.setAttribute("href",i),v.setAttribute("download",`Recurring-Expenses-${new Date().toISOString().split("T")[0]}.csv`),v.style.visibility="hidden",document.body.appendChild(v),v.click(),document.body.removeChild(v),g.fire({title:"Export Complete!",text:"Recurring expenses have been exported to CSV.",icon:"success",confirmButtonColor:"#28a745",timer:2e3,timerProgressBar:!0})}},fe=a=>({paid:"bg-success text-white",unpaid:"bg-warning text-dark",pending:"bg-info text-white",overdue:"bg-danger text-white",due:"bg-warning text-dark"})[a]||"bg-secondary text-white",ve=a=>({paid:"fas fa-check-circle",unpaid:"fas fa-exclamation-circle",pending:"fas fa-clock",overdue:"fas fa-exclamation-triangle",due:"fas fa-calendar-exclamation"})[a]||"fas fa-question-circle",ye=a=>({paid:"Paid",unpaid:"Unpaid",pending:"Pending",overdue:"Overdue",due:"Due"})[a]||a,be=a=>a?new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-",ge=async a=>{const o=await g.fire({title:"Mark as Paid",html:`
                    <div class="text-left">
                        <p>Mark <strong>${a.name}</strong> as paid?</p>
                        <div class="form-group mt-3">
                            <label for="paid_date">Payment Date:</label>
                            <input type="date" id="paid_date" class="form-control" value="${new Date().toISOString().split("T")[0]}">
                        </div>
                        <div class="form-group mt-3">
                            <label for="payment_notes">Payment Notes (optional):</label>
                            <textarea id="payment_notes" class="form-control" rows="3" placeholder="Add any payment notes..."></textarea>
                        </div>
                    </div>
                `,icon:"question",showCancelButton:!0,confirmButtonColor:"#28a745",confirmButtonText:"Mark as Paid",cancelButtonText:"Cancel",preConfirm:()=>{const l=document.getElementById("paid_date").value,r=document.getElementById("payment_notes").value;return l?{paidDate:l,paymentNotes:r}:(g.showValidationMessage("Please select a payment date"),!1)}});if(o.isConfirmed)try{if((await T.post(route("admin.finance.recurring.expenses.mark-paid",a.id),{paid_date:o.value.paidDate,payment_notes:o.value.paymentNotes})).data.success){const r=f.value.findIndex(v=>v.id===a.id);r!==-1&&(f.value[r]={...f.value[r],payment_status:"paid",last_paid_date:o.value.paidDate,payment_notes:o.value.paymentNotes}),await g.fire({title:"Success!",text:"Expense marked as paid successfully.",icon:"success",confirmButtonColor:"#28a745",timer:2e3,timerProgressBar:!0})}}catch(l){console.error("Error marking expense as paid:",l),await g.fire({title:"Error!",text:"Failed to mark expense as paid. Please try again.",icon:"error",confirmButtonColor:"#e74a3b"})}};return q(),{expenses:f,showAddModal:t,editingExpense:w,saving:s,form:m,USD_TO_BDT_RATE:I,formatNumber:M,formatFrequency:L,getFrequencyColor:ee,openAddModal:te,editExpense:se,closeModal:Y,saveExpense:ne,deleteExpense:ae,updateConvertedAmount:oe,clearAllExpenses:ue,exportExpenses:me,searchQuery:x,filteredExpenses:J,clearSearch:le,resetPaginationOnSearch:re,fetchExpenses:q,isLoading:R,totalItems:V,selectedExpenses:p,currentPage:E,itemsPerPage:n,totalPages:S,paginatedExpenses:A,visiblePages:K,changePage:ie,isAllSelected:Q,toggleSelectAll:de,deleteSelectedExpenses:ce,monthlyTotal:X,weeklyTotal:Z,yearlyTotal:$,getPaymentStatusColor:fe,getPaymentStatusIcon:ve,formatPaymentStatus:ye,formatDate:be,markAsPaid:ge}}},Se={class:"row"},Te={class:"col-lg-12"},De={class:"dashboard-settings margin-top-40"},Ae={class:"card mb-4"},Me={class:"card-header d-flex justify-content-between align-items-center"},qe={class:"btn-group"},Fe={class:"row mb-4"},Ie={class:"col-md-4"},Ne={class:"card border-primary"},Re={class:"card-body text-center"},Ue={class:"d-flex align-items-center justify-content-center mb-2"},Ve={class:"text-primary mb-0"},je={class:"col-md-4"},Oe={class:"card border-success"},Qe={class:"card-body text-center"},Le={class:"d-flex align-items-center justify-content-center mb-2"},He={class:"text-success mb-0"},Ye={class:"col-md-4"},We={class:"card border-danger"},ze={class:"card-body text-center"},Ge={class:"d-flex align-items-center justify-content-center mb-2"},Je={class:"text-danger mb-0"},Ke={class:"card"},Xe={class:"card-header"},Ze={class:"d-flex justify-content-between align-items-center flex-wrap gap-3"},$e={class:"d-flex align-items-center gap-3 flex-wrap"},et={class:"search-container"},tt={class:"input-group",style:{"min-width":"250px"}},st={class:"input-group-text"},nt={key:0,class:"fas fa-spinner fa-spin"},at={key:1,class:"fas fa-search"},ot={key:0,class:"form-check"},lt=["checked"],rt={class:"results-info"},it={class:"text-muted"},dt={key:0},ct={key:1},ut={key:0,class:"text-info"},mt={class:"card-body"},ft={class:"table-responsive d-none d-md-block"},vt={class:"table table-striped"},yt={class:"form-check"},bt=["value","id"],gt={class:"badge bg-warning text-dark"},pt={key:0,class:"text-muted"},xt={key:1,class:"text-muted"},ht={class:"btn-group",role:"group"},_t=["onClick"],kt=["onClick"],Ct=["onClick"],wt={key:0},Et={key:1},Bt={colspan:"8",class:"text-center text-muted py-5"},Pt={class:"d-flex flex-column align-items-center"},St={class:"mb-3"},Tt={class:"mb-2"},Dt={class:"d-md-none"},At={key:0,class:"text-center text-muted py-5"},Mt={key:1,class:"text-center text-muted py-5"},qt={class:"d-flex flex-column align-items-center"},Ft={class:"mb-3"},It={class:"mb-2"},Nt={class:"d-flex gap-2 flex-wrap justify-content-center"},Rt={class:"card border-start border-warning border-3"},Ut={class:"card-body p-3"},Vt={class:"d-flex align-items-start gap-3"},jt={class:"form-check"},Ot=["value","id"],Qt={class:"expense-info flex-grow-1"},Lt={class:"d-flex align-items-center mb-2"},Ht={class:"mb-0 expense-name fw-bold"},Yt={class:"expense-details"},Wt={key:0,class:"text-muted mb-2 small"},zt={class:"d-flex justify-content-between align-items-center mb-2"},Gt={class:"expense-amount"},Jt={class:"badge bg-warning text-dark fs-6"},Kt={class:"d-flex justify-content-between align-items-center flex-wrap gap-2"},Xt={class:"payment-status-mobile"},Zt={key:0,class:"next-due-mobile"},$t={class:"text-muted"},es={class:"expense-actions"},ts=["onClick"],ss={class:"d-flex gap-2"},ns=["onClick"],as=["onClick"],os={key:0,class:"d-flex justify-content-between align-items-center mt-4"},ls={class:"text-muted"},rs={key:0,class:"text-info"},is={"aria-label":"Recurring expenses pagination"},ds={class:"pagination pagination-sm mb-0"},cs=["disabled"],us=["onClick"],ms=["disabled"],fs={class:"modal-header"},vs={class:"modal-body"},ys={class:"row"},bs={class:"col-md-6 mb-3"},gs={class:"col-md-6 mb-3"},ps={class:"input-group"},xs={key:0,class:"form-text text-info"},hs={key:1,class:"form-text text-muted"},_s={class:"row"},ks={class:"col-md-6 mb-3"},Cs={class:"col-md-6 mb-3"},ws={class:"mb-3"},Es={class:"mb-3"},Bs={class:"d-flex justify-content-end gap-2"},Ps=["disabled"];function Ss(G,t,w,s,f,p){const E=he("Head");return c(),d(N,null,[_e(E,{title:"Recurring Expenses Management"}),e("div",Se,[e("div",Te,[e("div",De,[e("div",Ae,[e("div",Me,[t[31]||(t[31]=e("h4",{class:"mb-0"},[e("i",{class:"fas fa-repeat me-2"}),b(" Recurring Expenses Management ")],-1)),e("div",qe,[e("button",{onClick:t[0]||(t[0]=(...n)=>s.openAddModal&&s.openAddModal(...n)),class:"btn btn-primary"},[...t[27]||(t[27]=[e("i",{class:"fas fa-plus"},null,-1),b(" Add Recurring Expense ",-1)])]),s.selectedExpenses.length>0?(c(),d("button",{key:0,onClick:t[1]||(t[1]=(...n)=>s.deleteSelectedExpenses&&s.deleteSelectedExpenses(...n)),class:"btn btn-danger"},[t[28]||(t[28]=e("i",{class:"fas fa-trash"},null,-1)),b(" Delete Selected ("+u(s.selectedExpenses.length)+") ",1)])):h("",!0),s.expenses.length>0?(c(),d("button",{key:1,onClick:t[2]||(t[2]=(...n)=>s.exportExpenses&&s.exportExpenses(...n)),class:"btn btn-outline-success"},[...t[29]||(t[29]=[e("i",{class:"fas fa-download"},null,-1),b(" Export CSV ",-1)])])):h("",!0),s.expenses.length>0?(c(),d("button",{key:2,onClick:t[3]||(t[3]=(...n)=>s.clearAllExpenses&&s.clearAllExpenses(...n)),class:"btn btn-outline-danger"},[...t[30]||(t[30]=[e("i",{class:"fas fa-trash-alt"},null,-1),b(" Clear All ",-1)])])):h("",!0)])]),t[32]||(t[32]=e("div",{class:"card-body"},[e("p",{class:"text-muted"}," Manage monthly recurring expenses like server bills, office rent, subscriptions, etc. These will automatically appear in your balance sheet each month. ")],-1))]),e("div",Fe,[e("div",Ie,[e("div",Ne,[e("div",Re,[e("div",Ue,[t[34]||(t[34]=e("i",{class:"fas fa-calendar-day text-primary fs-3 me-2"},null,-1)),e("div",null,[t[33]||(t[33]=e("h6",{class:"text-muted mb-0"},"Monthly Total",-1)),e("h4",Ve,"৳"+u(s.formatNumber(s.monthlyTotal)),1)])]),t[35]||(t[35]=e("small",{class:"text-muted"},"All expenses converted to monthly basis",-1))])])]),e("div",je,[e("div",Oe,[e("div",Qe,[e("div",Le,[t[37]||(t[37]=e("i",{class:"fas fa-calendar-week text-success fs-3 me-2"},null,-1)),e("div",null,[t[36]||(t[36]=e("h6",{class:"text-muted mb-0"},"Weekly Total",-1)),e("h4",He,"৳"+u(s.formatNumber(s.weeklyTotal)),1)])]),t[38]||(t[38]=e("small",{class:"text-muted"},"Total weekly recurring costs",-1))])])]),e("div",Ye,[e("div",We,[e("div",ze,[e("div",Ge,[t[40]||(t[40]=e("i",{class:"fas fa-calendar-alt text-danger fs-3 me-2"},null,-1)),e("div",null,[t[39]||(t[39]=e("h6",{class:"text-muted mb-0"},"Yearly Total",-1)),e("h4",Je,"৳"+u(s.formatNumber(s.yearlyTotal)),1)])]),t[41]||(t[41]=e("small",{class:"text-muted"},"Total yearly recurring costs",-1))])])])]),e("div",Ke,[e("div",Xe,[e("div",Ze,[t[44]||(t[44]=e("h5",{class:"mb-0"},"Current Recurring Expenses",-1)),e("div",$e,[e("div",et,[e("div",tt,[e("span",st,[s.isLoading?(c(),d("i",nt)):(c(),d("i",at))]),k(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>s.searchQuery=n),type:"text",class:"form-control",placeholder:"Search by expense name...",onInput:t[5]||(t[5]=(...n)=>s.resetPaginationOnSearch&&s.resetPaginationOnSearch(...n))},null,544),[[F,s.searchQuery]]),s.searchQuery?(c(),d("button",{key:0,onClick:t[6]||(t[6]=(...n)=>s.clearSearch&&s.clearSearch(...n)),class:"btn btn-outline-secondary",type:"button",title:"Reset search"},[...t[42]||(t[42]=[e("i",{class:"fas fa-undo me-1"},null,-1),e("span",{class:"d-none d-md-inline"},"Reset",-1)])])):h("",!0)])]),s.filteredExpenses.length>0?(c(),d("div",ot,[e("input",{class:"form-check-input",type:"checkbox",checked:s.isAllSelected,onChange:t[7]||(t[7]=(...n)=>s.toggleSelectAll&&s.toggleSelectAll(...n)),id:"selectAllRecurring"},null,40,lt),t[43]||(t[43]=e("label",{class:"form-check-label",for:"selectAllRecurring"}," Select All ",-1))])):h("",!0),e("div",rt,[e("span",it,[s.isLoading?(c(),d("span",dt,"Loading...")):(c(),d("span",ct,[b(u(s.paginatedExpenses.length)+" of "+u(s.totalItems)+" items ",1),s.searchQuery?(c(),d("span",ut,' (search results for "'+u(s.searchQuery)+'") ',1)):h("",!0)]))])])])])]),e("div",mt,[e("div",ft,[e("table",vt,[t[51]||(t[51]=e("thead",null,[e("tr",null,[e("th",{width:"40"},[e("i",{class:"fas fa-check-square text-muted"})]),e("th",null,"Name"),e("th",null,"Description"),e("th",null,"Amount & Currency"),e("th",null,"Frequency"),e("th",null,"Payment Status"),e("th",null,"Next Due"),e("th",null,"Actions")])],-1)),e("tbody",null,[(c(!0),d(N,null,j(s.paginatedExpenses,n=>(c(),d("tr",{key:n.id},[e("td",null,[e("div",yt,[k(e("input",{class:"form-check-input",type:"checkbox",value:n.id,"onUpdate:modelValue":t[8]||(t[8]=x=>s.selectedExpenses=x),id:`recurring-expense-${n.id}`},null,8,bt),[[W,s.selectedExpenses]])])]),e("td",null,[e("strong",null,u(n.name),1)]),e("td",null,u(n.description||"-"),1),e("td",null,[e("span",gt," ৳"+u(s.formatNumber(n.bdt_amount||n.amount||n.default_amount)),1)]),e("td",null,[e("span",{class:C(["badge",s.getFrequencyColor(n.frequency)])},u(s.formatFrequency(n.frequency)),3)]),e("td",null,[e("span",{class:C(["badge",s.getPaymentStatusColor(n.payment_status)])},[e("i",{class:C(s.getPaymentStatusIcon(n.payment_status))},null,2),b(" "+u(s.formatPaymentStatus(n.payment_status)),1)],2)]),e("td",null,[n.next_due_date?(c(),d("small",pt,u(s.formatDate(n.next_due_date)),1)):(c(),d("small",xt,"-"))]),e("td",null,[e("div",ht,[n.payment_status!=="paid"?(c(),d("button",{key:0,onClick:x=>s.markAsPaid(n),class:"btn btn-sm btn-success",title:"Mark as Paid"},[...t[45]||(t[45]=[e("i",{class:"fas fa-check"},null,-1)])],8,_t)):h("",!0),e("button",{onClick:x=>s.editExpense(n),class:"btn btn-sm btn-outline-primary"},[...t[46]||(t[46]=[e("i",{class:"fas fa-edit"},null,-1)])],8,kt),e("button",{onClick:x=>s.deleteExpense(n.id),class:"btn btn-sm btn-outline-danger"},[...t[47]||(t[47]=[e("i",{class:"fas fa-trash"},null,-1)])],8,Ct)])])]))),128)),s.totalItems===0&&!s.searchQuery?(c(),d("tr",wt,[...t[48]||(t[48]=[e("td",{colspan:"8",class:"text-center text-muted py-4"},[e("i",{class:"fas fa-receipt fa-2x mb-3 d-block text-secondary"}),e("p",{class:"mb-0"},[b("No recurring expenses found."),e("br"),b('Click "Add Recurring Expense" to get started.')])],-1)])])):s.totalItems===0&&s.searchQuery?(c(),d("tr",Et,[e("td",Bt,[e("div",Pt,[t[50]||(t[50]=e("i",{class:"fas fa-search fa-2x mb-3 text-secondary"},null,-1)),e("div",St,[e("p",Tt,'No expenses match your search "'+u(s.searchQuery)+'".',1),t[49]||(t[49]=e("p",{class:"text-muted small mb-0"},"Try adjusting your search terms or reset to view all expenses.",-1))])])])])):h("",!0)])])]),e("div",Dt,[s.totalItems===0&&!s.searchQuery?(c(),d("div",At,[...t[52]||(t[52]=[e("i",{class:"fas fa-receipt fa-3x mb-3"},null,-1),e("p",null,[b("No recurring expenses found."),e("br"),b('Click "Add Recurring Expense" to get started.')],-1)])])):s.totalItems===0&&s.searchQuery?(c(),d("div",Mt,[e("div",qt,[t[56]||(t[56]=e("i",{class:"fas fa-search fa-3x mb-3 text-secondary"},null,-1)),e("div",Ft,[e("p",It,'No expenses match your search "'+u(s.searchQuery)+'".',1),t[53]||(t[53]=e("p",{class:"text-muted small"},"Try adjusting your search terms or reset to view all expenses.",-1))]),e("div",Nt,[e("button",{onClick:t[9]||(t[9]=(...n)=>s.clearSearch&&s.clearSearch(...n)),class:"btn btn-outline-primary"},[...t[54]||(t[54]=[e("i",{class:"fas fa-undo me-1"},null,-1),b(" Reset Search ",-1)])]),e("button",{onClick:t[10]||(t[10]=n=>s.showAddModal=!0),class:"btn btn-primary"},[...t[55]||(t[55]=[e("i",{class:"fas fa-plus me-1"},null,-1),b(" Add Expense ",-1)])])])])])):h("",!0),(c(!0),d(N,null,j(s.paginatedExpenses,n=>(c(),d("div",{key:n.id,class:"mobile-expense-card mb-3"},[e("div",Rt,[e("div",Ut,[e("div",Vt,[e("div",jt,[k(e("input",{class:"form-check-input mobile-checkbox",type:"checkbox",value:n.id,"onUpdate:modelValue":t[11]||(t[11]=x=>s.selectedExpenses=x),id:`mobile-expense-${n.id}`},null,8,Ot),[[W,s.selectedExpenses]])]),e("div",Qt,[e("div",Lt,[e("i",{class:C([n.icon||"fas fa-receipt","text-primary me-2 fs-5"])},null,2),e("h6",Ht,u(n.name),1)]),e("div",Yt,[n.description?(c(),d("p",Wt,[t[57]||(t[57]=e("i",{class:"fas fa-info-circle me-1"},null,-1)),b(" "+u(n.description),1)])):h("",!0),e("div",zt,[e("div",Gt,[e("span",Jt," ৳"+u(s.formatNumber(n.bdt_amount||n.amount||n.default_amount)),1)]),e("span",{class:C(["badge",s.getFrequencyColor(n.frequency)])},u(s.formatFrequency(n.frequency)),3)]),e("div",Kt,[e("div",Xt,[e("span",{class:C(["badge",s.getPaymentStatusColor(n.payment_status)])},[e("i",{class:C([s.getPaymentStatusIcon(n.payment_status),"me-1"])},null,2),b(" "+u(s.formatPaymentStatus(n.payment_status)),1)],2)]),n.next_due_date?(c(),d("div",Zt,[e("small",$t,[t[58]||(t[58]=e("i",{class:"fas fa-calendar-alt me-1"},null,-1)),b(" Due: "+u(s.formatDate(n.next_due_date)),1)])])):h("",!0)])])]),e("div",es,[n.payment_status!=="paid"?(c(),d("button",{key:0,onClick:x=>s.markAsPaid(n),class:"btn btn-success btn-sm w-100 mb-2 mobile-btn-paid",title:"Mark as Paid"},[...t[59]||(t[59]=[e("i",{class:"fas fa-check me-1"},null,-1),e("span",{class:"d-none d-sm-inline"},"Mark Paid",-1),e("span",{class:"d-sm-none"},"Paid",-1)])],8,ts)):h("",!0),e("div",ss,[e("button",{onClick:x=>s.editExpense(n),class:"btn btn-outline-primary btn-sm mobile-btn flex-fill"},[...t[60]||(t[60]=[e("i",{class:"fas fa-edit"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Edit",-1)])],8,ns),e("button",{onClick:x=>s.deleteExpense(n.id),class:"btn btn-outline-danger btn-sm mobile-btn flex-fill"},[...t[61]||(t[61]=[e("i",{class:"fas fa-trash"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Delete",-1)])],8,as)])])])])])]))),128))]),s.totalItems>s.itemsPerPage?(c(),d("div",os,[e("div",ls,[b(" Showing "+u((s.currentPage-1)*s.itemsPerPage+1)+" to "+u(Math.min(s.currentPage*s.itemsPerPage,s.totalItems))+" of "+u(s.totalItems)+" entries ",1),s.searchQuery?(c(),d("span",rs," (search results) ")):h("",!0)]),e("nav",is,[e("ul",ds,[e("li",{class:C(["page-item",{disabled:s.currentPage===1}])},[e("button",{class:"page-link",onClick:t[12]||(t[12]=n=>s.changePage(s.currentPage-1)),disabled:s.currentPage===1},[...t[62]||(t[62]=[e("i",{class:"fas fa-chevron-left"},null,-1)])],8,cs)],2),(c(!0),d(N,null,j(s.visiblePages,n=>(c(),d("li",{key:n,class:C(["page-item",{active:n===s.currentPage}])},[e("button",{class:"page-link",onClick:x=>s.changePage(n)},u(n),9,us)],2))),128)),e("li",{class:C(["page-item",{disabled:s.currentPage===s.totalPages}])},[e("button",{class:"page-link",onClick:t[13]||(t[13]=n=>s.changePage(s.currentPage+1)),disabled:s.currentPage===s.totalPages},[...t[63]||(t[63]=[e("i",{class:"fas fa-chevron-right"},null,-1)])],8,ms)],2)])])])):h("",!0)])]),s.showAddModal||s.editingExpense?(c(),d("div",{key:0,class:"modal-overlay",onClick:t[26]||(t[26]=(...n)=>s.closeModal&&s.closeModal(...n))},[e("div",{class:"modal-content",onClick:t[25]||(t[25]=z(()=>{},["stop"]))},[e("div",fs,[e("h5",null,u(s.editingExpense?"Edit":"Add")+" Recurring Expense",1),e("button",{onClick:t[14]||(t[14]=(...n)=>s.closeModal&&s.closeModal(...n)),class:"btn-close"},"×")]),e("div",vs,[e("form",{onSubmit:t[24]||(t[24]=z((...n)=>s.saveExpense&&s.saveExpense(...n),["prevent"]))},[e("div",ys,[e("div",bs,[t[64]||(t[64]=e("label",{class:"form-label"},"Name *",-1)),k(e("input",{"onUpdate:modelValue":t[15]||(t[15]=n=>s.form.name=n),type:"text",class:"form-control",required:"",placeholder:"e.g., Office Rent, Server Bills"},null,512),[[F,s.form.name]])]),e("div",gs,[t[68]||(t[68]=e("label",{class:"form-label"},"Default Amount *",-1)),e("div",ps,[k(e("select",{"onUpdate:modelValue":t[16]||(t[16]=n=>s.form.currency=n),class:"input-group-text",style:{"border-right":"0",background:"#e9ecef"}},[...t[65]||(t[65]=[e("option",{value:"BDT"},"৳",-1),e("option",{value:"USD"},"$",-1)])],512),[[O,s.form.currency]]),k(e("input",{"onUpdate:modelValue":t[17]||(t[17]=n=>s.form.default_amount=n),type:"number",class:"form-control",step:"0.01",min:"0",required:"",placeholder:"0.00",onInput:t[18]||(t[18]=(...n)=>s.updateConvertedAmount&&s.updateConvertedAmount(...n))},null,544),[[F,s.form.default_amount,void 0,{number:!0}]])]),s.form.currency==="USD"?(c(),d("div",xs,[e("small",null,[t[66]||(t[66]=e("i",{class:"fas fa-exchange-alt me-1"},null,-1)),b(" Converted: ৳"+u(s.formatNumber(s.form.default_amount*s.USD_TO_BDT_RATE))+" BDT (1 USD = "+u(s.USD_TO_BDT_RATE)+" BDT) ",1)])])):(c(),d("div",hs,[...t[67]||(t[67]=[e("small",null,"Amount in Bangladeshi Taka (BDT)",-1)])]))])]),e("div",_s,[e("div",ks,[t[70]||(t[70]=e("label",{class:"form-label"},"Icon",-1)),k(e("select",{"onUpdate:modelValue":t[19]||(t[19]=n=>s.form.icon=n),class:"form-select"},[...t[69]||(t[69]=[ke('<option value="fas fa-receipt" data-v-d473c844>Receipt (Default)</option><option value="fas fa-server" data-v-d473c844>Server</option><option value="fas fa-building" data-v-d473c844>Building/Rent</option><option value="fas fa-bolt" data-v-d473c844>Electricity</option><option value="fas fa-wifi" data-v-d473c844>Internet/WiFi</option><option value="fas fa-tools" data-v-d473c844>Tools/Software</option><option value="fas fa-broom" data-v-d473c844>Cleaning</option><option value="fas fa-shopping-cart" data-v-d473c844>Supplies</option><option value="fas fa-shield-alt" data-v-d473c844>Insurance</option><option value="fas fa-bullhorn" data-v-d473c844>Marketing</option><option value="fas fa-credit-card" data-v-d473c844>Payment/Subscription</option>',11)])],512),[[O,s.form.icon]])]),e("div",Cs,[t[72]||(t[72]=e("label",{class:"form-label"},"Frequency",-1)),k(e("select",{"onUpdate:modelValue":t[20]||(t[20]=n=>s.form.frequency=n),class:"form-select",required:""},[...t[71]||(t[71]=[e("option",{value:"monthly"},"Monthly",-1),e("option",{value:"yearly"},"Yearly",-1),e("option",{value:"weekly"},"Weekly",-1)])],512),[[O,s.form.frequency]])])]),e("div",ws,[t[73]||(t[73]=e("label",{class:"form-label"},"Description",-1)),k(e("textarea",{"onUpdate:modelValue":t[21]||(t[21]=n=>s.form.description=n),class:"form-control",rows:"3",placeholder:"Brief description of this expense"},null,512),[[F,s.form.description]])]),e("div",Es,[t[74]||(t[74]=e("label",{class:"form-label"},"Tooltip (Help Text)",-1)),k(e("input",{"onUpdate:modelValue":t[22]||(t[22]=n=>s.form.tooltip=n),type:"text",class:"form-control",placeholder:"Help text shown to users"},null,512),[[F,s.form.tooltip]])]),e("div",Bs,[e("button",{type:"button",onClick:t[23]||(t[23]=(...n)=>s.closeModal&&s.closeModal(...n)),class:"btn btn-secondary"}," Cancel "),e("button",{type:"submit",class:"btn btn-primary",disabled:s.saving},[t[75]||(t[75]=e("i",{class:"fas fa-save"},null,-1)),b(" "+u(s.saving?"Saving...":"Save"),1)],8,Ps)])],32)])])])):h("",!0)])])])],64)}const qs=Be(Pe,[["render",Ss],["__scopeId","data-v-d473c844"]]);export{qs as default};
